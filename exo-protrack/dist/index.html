<!doctype html>
<html lang="ru">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  
  <!-- PWA Meta Tags -->
  <meta name="theme-color" content="#0f172a" />
  <meta name="description" content="Система мониторинга производства и прослеживаемости EXO ProTrack" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
  <meta name="apple-mobile-web-app-title" content="EXO ProTrack" />
  <meta name="mobile-web-app-capable" content="yes" />
  <meta name="msapplication-TileColor" content="#0f172a" />
  <meta name="msapplication-tap-highlight" content="no" />
  
  <!-- Open Graph -->
  <meta property="og:type" content="website" />
  <meta property="og:title" content="EXO ProTrack" />
  <meta property="og:description" content="Система мониторинга производства и прослеживаемости" />
  <meta property="og:site_name" content="EXO ProTrack" />
  
  <!-- Favicon -->
  <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
  <link rel="apple-touch-icon" href="/icons/icon-192.png" />
  <link rel="mask-icon" href="/favicon.svg" color="#0f172a" />
  
  <!-- Manifest -->
  <link rel="manifest" href="/manifest.json" />
  
  <title>EXO ProTrack</title>
  
  <style>
    /* Critical CSS для загрузки */
    :root {
      --background: #ffffff;
      --surface: #f8fafc;
      --text: #0f172a;
      --primary: #3b82f6;
    }
    
    .dark {
      --background: #0f172a;
      --surface: #1e293b;
      --text: #f8fafc;
      --primary: #60a5fa;
    }
    
    @media print {
      body * {
        visibility: hidden;
      }
      .print-area, .print-area * {
        visibility: visible;
      }
      .print-area {
        position: absolute;
        left: 0;
        top: 0;
        width: 100%;
      }
      .no-print {
        display: none !important;
      }
    }
    
    /* Loading spinner для offline режима */
    #loading {
      position: fixed;
      inset: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      background: var(--background);
      color: var(--text);
      font-family: system-ui, sans-serif;
      z-index: 9999;
    }
    
    #loading .spinner {
      width: 40px;
      height: 40px;
      border: 3px solid var(--surface);
      border-top-color: var(--primary);
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }
    
    @keyframes spin {
      to { transform: rotate(360deg); }
    }
  </style>
  <script type="module" crossorigin src="/assets/index-ozQCx7Zy.js"></script>
  <link rel="stylesheet" crossorigin href="/assets/index-CDovKvIt.css">
</head>

<body>
  <div id="root">
    <div id="loading">
      <div class="spinner"></div>
    </div>
  </div>
  
  
  <script>
    // Регистрация Service Worker
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', async () => {
        try {
          const registration = await navigator.serviceWorker.register('/sw.js', {
            scope: '/'
          });
          
          console.log('SW registered:', registration.scope);
          
          // Проверка обновлений
          registration.addEventListener('updatefound', () => {
            const newWorker = registration.installing;
            if (newWorker) {
              newWorker.addEventListener('statechange', () => {
                if (newWorker.state === 'installed' && navigator.serviceWorker.controller) {
                  // Новая версия доступна
                  console.log('New SW version available');
                  // Можно показать уведомление пользователю
                }
              });
            }
          });
          
          // Проверка разрешения на уведомления
          if ('Notification' in window && Notification.permission === 'default') {
            // Можно запросить permission при первом входе
          }
          
        } catch (error) {
          console.error('SW registration failed:', error);
        }
      });
    }
    
    // Offline/Online индикатор
    window.addEventListener('offline', () => {
      document.body.setAttribute('data-offline', 'true');
    });
    
    window.addEventListener('online', () => {
      document.body.removeAttribute('data-offline');
    });
  </script>
</body>

</html>
